From: Matthias Klumpp <matthias@tenstral.net>
Date: Mon, 14 Jul 2014 15:30:17 +0000
Subject: Adjust to AppStream 0.7 API change
X-Git-Url: http://quickgit.kde.org/?p=apper.git&a=commitdiff&h=4c728a349a926ef13b38a6def909e27d01113a99
---
Adjust to AppStream 0.7 API change
---


--- a/libapper/AppStream.cpp
+++ b/libapper/AppStream.cpp
@@ -82,6 +82,7 @@
         AsComponent *cpt;
         GPtrArray *sshot_array;
         AsScreenshot *sshot;
+        gchar **pkgs;
         cpt = (AsComponent*) g_ptr_array_index(cptArray, i);
         // we only want desktop apps at time
         if (as_component_get_kind (cpt) != AS_COMPONENT_KIND_DESKTOP_APP)
@@ -92,7 +93,10 @@
         app.name = QString::fromUtf8(as_component_get_name(cpt));
 
         // Package name
-        QString pkgName = QString::fromUtf8(as_component_get_pkgname(cpt));
+        pkgs = as_component_get_pkgnames(cpt);
+        QString pkgName;
+        if (pkgs != NULL)
+            pkgName = QString::fromUtf8(pkgs[0]);
 
         // Desktop file
         app.id = QString::fromUtf8(as_component_get_id(cpt));

